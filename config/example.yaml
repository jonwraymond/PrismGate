# Gatemini example configuration
# Copy to ~/.config/gatemini/config.yaml and customize.
#
# ── Secret Modes ──────────────────────────────────────────────────────
#
# Mode 1: Direct env vars (simplest)
#   env:
#     API_KEY: "${MY_API_KEY}"          # resolved at config load from env/`.env`
#
# Mode 2: secretref with env fallback (share configs between BWS and non-BWS users)
#   env:
#     API_KEY: "secretref:bws:project/dotenv/key/MY_API_KEY"
#   When BWS is enabled  → resolved via Bitwarden Secrets Manager
#   When BWS is disabled → extracts "MY_API_KEY" and resolves via env var
#   Zero config change needed for non-BWS users — just set MY_API_KEY in .env
#
# Mode 3: BWS enabled (full Bitwarden Secrets Manager)
#   Uncomment the secrets section below and set BWS_ACCESS_TOKEN + BWS_ORG_ID
#
# ── .env file locations (loaded in order, later overrides earlier) ────
#   1. ~/.env
#   2. ~/.config/gatemini/.env
#   3. Sibling of this config file (e.g., same directory)
# ──────────────────────────────────────────────────────────────────────

log_level: info

# Uncomment to enable BWS (Mode 3):
# secrets:
#   strict: true
#   providers:
#     bws:
#       enabled: true
#       access_token: "${BWS_ACCESS_TOKEN}"
#       organization_id: "${BWS_ORG_ID}"

backends:
  # ── Stdio backends ─────────────────────────────────────────────────

  # No secrets needed
  sequential-thinking:
    command: mcp-server-sequential-thinking
    timeout: 120s

  # Mode 1: direct env var (set CEREBRAS_API_KEY in .env or shell)
  cerebras:
    command: cerebras-mcp
    env:
      CEREBRAS_API_KEY: "${CEREBRAS_API_KEY}"
    timeout: 120s

  # Backend with npx (no local install required)
  playwright:
    command: npx
    args: ["-y", "@playwright/mcp@latest"]
    timeout: 120s

  # ── Streamable-HTTP backends ────────────────────────────────────────

  # Mode 2: secretref with env fallback
  # Works with BWS enabled OR with GITHUB_PAT_TOKEN env var
  github:
    transport: streamable-http
    url: "https://api.githubcopilot.com/mcp/"
    headers:
      Authorization: "Bearer secretref:bws:project/dotenv/key/GITHUB_PAT_TOKEN"
    timeout: 60s

  # Mode 2: secretref with env fallback
  context7:
    transport: streamable-http
    url: "https://mcp.context7.com/mcp"
    headers:
      CONTEXT7_API_KEY: "secretref:bws:project/dotenv/key/CONTEXT7_API_KEY"
    timeout: 90s

  # Public HTTP backend (no auth required)
  deepwiki:
    transport: streamable-http
    url: "https://mcp.deepwiki.com/mcp"
    timeout: 90s

health:
  interval: 30s
  timeout: 5s
  failure_threshold: 3
  max_restarts: 5
  restart_window: 60s

admin:
  enabled: false
  listen: "127.0.0.1:19999"

sandbox:
  timeout: 30s
  max_output_size: 200000
